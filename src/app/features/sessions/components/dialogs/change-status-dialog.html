<div class="status-dialog-content">
    <!-- Advertencia -->
    <div class="titulo-regi">
        <p-message
            severity="warn"
            text="Este cambio de estado afectar치 el flujo de trabajo de la sesi칩n."
            styleClass="mb-3"
        ></p-message>
    </div>

    @if (getCompletedWarning()) {
    <p-message severity="warn" [text]="getCompletedWarning()" styleClass="mb-3"></p-message>
    }

    <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <!-- Estados: Actual y Nuevo en Grid -->
        <div class="status-grid mb-3">
            <!-- Estado Actual -->
            <div class="field">
                <label class="block text-900 font-medium mb-2 text-sm">Estado Actual</label>
                <div class="status-badge-container">
                    <span class="status-badge">{{ getCurrentStatusLabel() }}</span>
                </div>
            </div>

            <!-- Nuevo Estado -->
            <div class="field">
                <label for="newStatus" class="block text-900 font-medium mb-2 text-sm">
                    Nuevo Estado <span class="text-red-500">*</span>
                </label>
                <p-select
                    id="newStatus"
                    formControlName="to_status"
                    [options]="statusOptions()"
                    optionLabel="label"
                    optionValue="value"
                    placeholder="-- Seleccionar --"
                    styleClass="w-full"
                ></p-select>
                @if ( form.get('to_status')?.invalid && form.get('to_status')?.touched ) {
                <small class="p-error block mt-1">El nuevo estado es requerido</small>
                }
            </div>
        </div>

        <!-- Raz칩n y Notas -->
        <div class="field mb-3">
            <label for="reason" class="block text-900 font-medium mb-2 text-sm">Raz칩n</label>
            <textarea
                pInputTextarea
                id="reason"
                formControlName="reason"
                rows="2"
                placeholder="Motivo del cambio de estado..."
                class="w-full"
            ></textarea>
        </div>

        <div class="field mb-4">
            <label for="notes" class="block text-900 font-medium mb-2 text-sm">Notas</label>
            <textarea
                pInputTextarea
                id="notes"
                formControlName="notes"
                rows="2"
                placeholder="Notas adicionales..."
                class="w-full"
            ></textarea>
        </div>

        <!-- Actions -->
        <div class="flex justify-content-end gap-2 pt-3 border-top-1 border-200">
            <p-button
                label="Cancelar"
                type="button"
                severity="secondary"
                [text]="true"
                (onClick)="cancel()"
            />
            <p-button
                label="Cambiar Estado"
                type="submit"
                [disabled]="form.invalid || submitting()"
                [loading]="submitting()"
            />
        </div>
    </form>
</div>
